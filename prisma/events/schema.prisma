generator client {
  provider = "prisma-client-js"
  output   = "../../node_modules/@prisma/client-events"
}

datasource db {
  provider = "postgresql"
  url      = env("EVENTS_DATABASE_URL")
}

model AuditLog {
  id          String   @id @default(uuid())
  userId      String   @map("user_id")
  userName    String   @map("user_name")
  eventType   EventType @map("event_type")
  eventAction String   @map("event_action")
  oldData     Json?    @map("old_data")
  newData     Json?    @map("new_data")
  ipAddress   String?  @map("ip_address")
  userAgent   String?  @map("user_agent")
  
  createdAt   DateTime @default(now()) @map("created_at")
  
  @@index([userId, createdAt])
  @@index([eventType, createdAt])
  @@map("audit_logs")
}

enum EventType {
  PROFILE_UPDATE
  PASSWORD_CHANGE
  PHOTO_UPDATE
  PHONE_UPDATE
  ATTENDANCE_CLOCK_IN
  ATTENDANCE_CLOCK_OUT
  EMPLOYEE_CREATED
  EMPLOYEE_UPDATED
  EMPLOYEE_DELETED
}

model Notification {
  id          String   @id @default(uuid())
  recipientId String   @map("recipient_id")
  senderId    String   @map("sender_id")
  senderName  String   @map("sender_name")
  type        NotificationType
  title       String
  message     String
  metadata    Json?
  isRead      Boolean  @default(false) @map("is_read")
  readAt      DateTime? @map("read_at")
  
  createdAt   DateTime @default(now()) @map("created_at")
  
  @@index([recipientId, isRead, createdAt])
  @@map("notifications")
}

enum NotificationType {
  PROFILE_UPDATED
  PHOTO_CHANGED
  PASSWORD_CHANGED
  PHONE_UPDATED
  NEW_EMPLOYEE
  EMPLOYEE_UPDATED
  INFO
  WARNING
  SUCCESS
}